%% 
%% Copyright 2007-2019 Elsevier Ltd
%% 
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%% 
%% Template article for Elsevier's document class `elsarticle'
%% with harvard style bibliographic references

%\documentclass[preprint,12pt,authoryear]{elsarticle}

%% Use the option review to obtain double line spacing
\documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times,authoryear]{elsarticle}
%% \documentclass[final,1p,times,twocolumn,authoryear]{elsarticle}
%% \documentclass[final,3p,times,authoryear]{elsarticle}
%% \documentclass[final,3p,times,twocolumn,authoryear]{elsarticle}
%% \documentclass[final,5p,times,authoryear]{elsarticle}
%% \documentclass[final,5p,times,twocolumn,authoryear]{elsarticle}

%% For including figures, graphicx.sty has been loaded in
%% elsarticle.cls. If you prefer to use the old commands
%% please give \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

\usepackage{siunitx}  % for degree celsius
\usepackage{multirow} % for the table
\usepackage{booktabs} % fot toprule, midrule
\usepackage{longtable}

\usepackage{color,soul} % highlight 

% for track changes in revision version, comment this one if want the final version
%\usepackage{changes}
%\usepackage[final]{changes}

\usepackage{hyperref} %for breaking long url

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
%% \usepackage{lineno}

\usepackage{lineno}
\linenumbers

\journal{Remote Sensing of Environment}

\begin{document}

\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for theassociated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for theassociated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for theassociated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

%\ead{huanglingcao@link.cuhk.edu.hk}

\title{Automatically quantifying evolution of retrogressive thaw slumps in Beiluhe (Tibetan Plateau) using multi-temporal CubeSat images}

%\title{Mapping Retrogressive Thaw Slumps in the Beiluhe Region (Tibetan Plateau) from CubeSat Images using Deep Learning}

%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{}
%% \address[label1]{}
%% \address[label2]{}

\author[a]{Lingcao Huang}
\author[a]{Lin Liu}
\author[b]{more}
%\author[b]{Jing Luo}
%\author[b]{Zhanju Lin}
%\author[b]{Fujun Niu}



\address[a]{Earth System Science Programme, Faculty of Science, The Chinese University of Hong Kong, Hong Kong SAR, China.}
\address[b]{Add a few more co-authors?}
%\address[b]{Northwest Institute of Eco-Environment and Resources, Chinese Academy of Sciences, Lanzhou, China.}

\begin{abstract}

Retrogressive thaw slumps (RTSs) are among the most dynamic landforms resulting from the thawing of ice-rich permafrost. 
However, their distribution and evolution are poorly quantified due to the challenges in accurately mapping them from remote sensing images. 
Building on the previous work on mapping RTSs using deep learning, we apply the same method to multi-temporal images, aiming to quantify RTS development in different years. 
%Firstly, we selected 36 active RTSs in Beiluhe on the Tibetan Plateau and manually delineated their boundaries on Planet CubeSat images taken in July 2017, 2018, and 2019. 
%Secondly, we derived training data from these boundaries and Planet images, then trained the DeepLabv3+ model. 
%Thirdly, we predicted RTSs in 2017, 2018, and 2019 Planet images using the well-trained model. Lastly, we conducted polygon-based change detection (2017 vs. 2018 and 2018 vs. 2019) on the mapped RTSs in different years, then obtained change polygons corresponding to the expanding areas toward upslope. 
%The results show that from 2017 to 2018, there are 35 change polygons, and their areas range from 108 $m^2$ to 2273 $m^2$ with a mean of 1284 $m^2$; 
%from 2018 to 2019, 31 change polygons are obtained, and their minimum, maximum, and average areas are 142 $m^2$, 9360 $m^2$, and 1913 $m^2$, respectively. 
%Visual inspection shows that most change polygons can accurately outline the expanding areas, yet a few of them are false positives, and a few expanding areas are missed. 
One advantage of using multi-temporal images to map RTSs then quantify their development is that this strategy can significantly reduce incorrect mapping results because a specific incorrect one would unlikely occur at the same location across multi-temporal images. 
However, outlining the expanding areas requires very high accuracy of delineating RTSs in different images. 
This study demonstrates that the deep-learning-based mapping method can potentially apply to large areas for mapping RTSs and quantifying their development if high-resolution remote sensing images are available.  


\end{abstract}

\begin{keyword}
%% keywords here, in the form: keyword \sep keyword

%% PACS codes here, in the form: \PACS code \sep code

%% MSC codes here, in the form: \MSC code \sep code
%% or \MSC[2008] code \sep code (2000 is the default)
CubeSat  \sep Deep Learning \sep Permafrost \sep Retrogressive Thaw Slumps \sep   Remote Sensing.

\end{keyword}

\end{frontmatter}

%% \linenumbers
%\tableofcontents

%% main text
\section{Introduction}
\label{sec_intro}

% some background
Permafrost is the ground that remains 0$^\circ$C for at least two consecutive years and is warming at the global scale \citep{biskaborn2019permafrost}. 
Permafrost warming can cause permafrost degradation including active layer thickening, development of thermokarst landforms, shrinking of permafrost extent \citep{czudek_thermokarst_1970,jorgenson_response_2005,osterkamp2007Characteristics,aakerman2008thawing,zhao2010Thermal}. 
Furthermore, it can threaten the safety of infrastructure, release greenhouse gases, and alter the local ecosystem \citep{tong_effect_1996,yang2010permafrost,bowden2010climate,grosse_vulnerability_2011,vonk2015reviews,schuur_climate_2015,olefeldt_circumpolar_2016,schuster2018permafrost,hjort2018degrading}.


% Introduction on the retrogressive thaw slumps
A retrogressive thaw slump (RTS) is one of dynamic landforms resulting from the thawing of ice-rich permafrost \citep{czudek_thermokarst_1970, jorgenson_thermokarst_2013,farquharson2016spatial,jones2019rapid}. 
Usually, RTSs are triggered by lateral stream erosion or active layer detachments \citep{french2017periglacial} and can be active for decades \citep{burn1989geomorphology, lacelle2010climatic, swanson2018growth}. 
For instance, a detachment slide occurs due to the melting of ground ice or intensive precipitation and removes soil above permafrost, then exposes it to rapid thawing and initiates an RTS. 
The main component of an RTS are the headwall, slump floor, and slump lobe \citep{lantuit_fifty_2008}. 
At the headwall, the exposed permafrost can continue thawing in each summer, which would further expands the thawed area towards upslope \citep{french2017periglacial}. 
Moreover, RTSs can significantly alter the local ecosystem such as mass wasting of soil as well as vegetation \citep{gooseff2009effects} and increases of mercury concentrations in the downstream aquatic environment \citep{pierre2018unprecedented}.


% literature on the occurrence and development of RTSs.
The occurrence and dynamics of RTSs have been reported in many local permafrost areas, but their development in most areas is still unknown. 
The RTS occurrence has been reported in northern and central Alaska (e.g., \citealp{swanson2018growth,balser2014timing}), northern Canada (e.g., \citealp{burn1990canadian, cassidy2017impacts, armstrong2018thaw,lewkowicz2019extremes}) , Siberia (e.g., \citealp{leibman2003dynamics, zwieback2018sub}) and the Tibetan Plateau (e.g., \citealp{niu2005engineering, niu2016thaw}). 
As reported in some local or regional regions, their number and affected areas also increased dramatically in recent decades \citep{luo2019recent, lewkowicz2019extremes}.
Typical, their retreat rates are 6--8 m yr$^{-1}$ \citep{jorgenson_thermokarst_2013}, but vary in different regions such as 16 m yr$^{-1}$ reported in Yukon Territory \citep{burn1989geomorphology} and 38 m yr$^{-1}$  in Alaska \citep{swanson2018growth}.
However, the occurrence and retreat rates of RTSs in most permafrost areas are still unknown, especially on the Tibetan Plateau. 
%Possible reasons include (1) RTSs scatter in remote and inaccessible regions, which makes field measurements challenging and (2) their small size as well as similarity to the surroundings presents difficulties for the automatic algorithms utilizing remote sensing images.  

% why we need an automatically method. 
An automatically mapping method is essential for quantifying RTS development throughout permafrost areas. 
Permafrost underlays approximately one-quarter of the land surface in the Northern Hemisphere \citep{zhang1999statistics} and most areas are remote and inaccessible. 
Therefore, it is impossible to conduct field measurement for RTS development. 
The advance of remote sensing satellites, especially, the CubeSat constellation provides multi-temporal and high-resolution images covering the global land surface. 
Manual delineation on these images can be used to quantify RTSs development but it is impractical due to large areas and the huge volume of images as well as its characteristics of time-consuming and labor-intensive. 
Therefore, automatic methods are necessary for addressing the unknown question related RTSs development throughout permafrost areas. 


% Motivation
Combining the deep learning algorithms and multi-temporal CubeSat images can automatically quantify the RTSs development.
A previous work has utilized deep learning algorithms to automatically delineate RTSs and output accurate mapping results \citep{huang2020using}. 
We can apply the same mapping method to multi-temporal images then delineate the RTSs in multi-temporal images. 
By comparing these multi-temporal RTS boundaries, we can quantify the development of these RTSs and obtain their retreat rate. 

%Evolution of retrogressive thaw slumps is poor quantified in most permafrost areas. 
%NO study on mapping RTS development automatically. 

% Objectives, outline of this paper and contributions 
The objectives of this study are (1) to extend the automatic mapping method proposed by \cite{huang2020using} to multi-temporal images and (2) to develop a method to automatically quantify the RTS development based on multi-temporal mapping results and obtain their retreat rates. 
We train a single DeepLabv3+ model using multi-temporal images then use this model to predict RTS boundaries in different years.
Then we propose a polygon-based change detection to remove incorrect mapping results and obtain change polygons covering expanding areas.  
We calculate the medial axis of each change polygon, then based on the medial axis to obtain the retreat rates.  
We also run the k-fold (k=3,5,10) cross-validation evaluate the robustness of mapping method when applying to multi-temporal images and conduct the statistics of RTSs development in Beiluhe on the Tibetan Plateau. 
To the best of our knowledge, this would be the first study that provides an automatic method for quantifying RTS development on remote sensing images and very first study reporting RTS retreat rates on the Tibetan Plateau. 

%Contribution of this work: (1) provide an automatic method for calculating the retreat distance (no matter the RTS boundaries are from manual delineation or automatic mapping). 
%(2) What’s the IOU value of mapping polygons are required for automatic change detection? For polygon-based change detection, we also can calculate F1 score, but it rely on the accuracies of mapping results. \\\\



\section{Study area and data}
\label{sec_studyarea_data}

% Study area
The Beiluhe region ($92.50^\circ$E to $93.51^\circ$E, $34.69^\circ$N to $35.18^\circ$N) on the Tibetan Plateau (Fig. \ref{fig_multi_rts_image_studyarea}a) is our study area.
The elevation is between 4418 and 5320 m; mean annual air temperature is \SI{-3.8}{\celsius}; annual precipitation is around 300 mm  \citep{luo_thermokarst_2015}.
It is underlain by ice-rich permafrost with thickness ranges from 20 to 80 m: 70\% and 20\% of this region has ice content greater than 30\% and 50\%, respectively \citep{zhou_geocryology_2000, luo_thermokarst_2015}; 
the type of ground ice is mainly massive ice \citep{guodong1983mechanism}. 
The active layer thickness and mean annual ground temperature ($\sim$15 m) ranges from 1.5 to 2.0 m and \SI{-2.0} to \SI{-0.5}{\celsius}, respectively \citep{zhou_geocryology_2000, wu2010changes, luo_thermokarst_2015,  wu2015changes}. 
As reported by a few studies, more than 200 RTSs developed in this region and their number and affected areas increased dramatically in the past decade \citep{huang2020using,luo2019recent}.  
For example, an RTS developed toward upslope from 2017 to 2019, and the development is captured by Planet CubeSat as shown in Fig. \ref{fig_multi_rts_image_studyarea} b to d. 
We also choose a region (i.e., Test area) next to Beiluhe as shown in Fig. \ref{fig_multi_rts_image_studyarea}a for testing our automatic method. 
The test area has 50 RTSs \citep{huang2020using} but does not have more detailed ground information. 

% Area for testing, should mention it here? I don't think so. Mentioned as above. 
%Test area: 50 RTS \citep{huang2020using}.

%[ht]
\begin{figure} 
	\centering
	\includegraphics[width=14cm]{figs/rts_multi_images_study_area_v2_trim.jpg}
	\caption{The study area and development of a retrogressive thaw slump (RTS). The red and black rectangle in (a) shows the extent of our study area and test area on the Tibetan Plateau. (b) to (d) are Planet images (2017, 2018, and 2019) of an RTS whose central location is 92.912$^\circ$ E, 34.848$^\circ$ N. The white arrows point the position of the headwall. In (b), the yellow arrow indicates the upslope direction.}
	\label{fig_multi_rts_image_studyarea}
\end{figure}



%Data
The data include images from Planet CubeSat \citep{team2017planet} and RTS boundaries in July 2017, 2018, and 2019.
%address why only choose the images starting from 2017? 
We only use images after 2017 because images from Planet CubeSat constellation are available after that time in our study area.  
These images have four bands (blue, green, red, and near-infrared) with the spatial resolution of 3 m. 
%And a list of all the images are presented Table ? in supplementary files. 
%TODO: Put a list to in the supplementary materials for all the image file name
The RTS boundaries are derived from manual delineation of Planet images, parts of which will be used for training our automatic method. 
We consider all the RTS boundaries as ground truths in the validation step.
The steps of downloading as well as pre-processing of Planet images and collecting ground truths are presented by \cite{huang2020using}.


\section{Methods}
\label{sec_meth}

%TODO: add something,

\subsection{Co-registration of multi-temporal planet images}
\label{subsec_coregistration}

%Preparing multi-temporal Planet CubeSat images. 
%download, extract three bands, sharpening, co-registration. \\\\
%collection of ground truth polygons from multi-temporal Planet images. \\\\
%Mapping method: the same to the 2020 RSE paper. \\\\

\subsection{Training using multi-temporal planet images}
\label{subsec_training}


\subsection{Polygon-based change detection}
\label{subsec_polygonchangeDet}

%Polygon-based change detection. \\\\

\subsection{Calculating retreat distance}
\label{subsec_cal_retreat_dis}

%Calculating the retreat distance. \\\\

\subsection{Post-processing}
\label{subsec_post_processing}

%Removing false positives based on multi-temporal images. \\\\

\subsection{Validation}
\label{subsec_post_processing}

%Validation. \\\\\


%The data we show here are good but not sufficient for the conclusion. 

\section{Discussion}
\label{sec_discussion}


good

\section{Conclusions}
\label{sec_conclusion}


 good

\section{Data and codes}
\label{sec_data_codes}

Planet images can be downloaded via. 
Codes are available on GitHub (\url{https://github.com/yghlc/ChangeDet_DL}) after the acceptance of this paper.

\section{Acknowledgments}
\label{sec_acknowledgments}

Thanks to ...


%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
%% \appendix

%% \section{}
%% \label{}

\section{References}
\label{sec_reference}

%% If you have bibdatabase file and want bibtex to generate the
%% bibitems, please use
%%
\bibliographystyle{elsarticle-harv} 
%\bibliography{poygon_based_rts_changeDet.bib}
% the bib file in "~/codes/Texpad/shared_files"
\bibliography{permafrost_rs_ref.bib}

%% else use the following coding to input the bibitems directly in the
%% TeX file.

%\begin{thebibliography}{00}
%
%%% \bibitem[Author(year)]{label}
%%% Text of bibliographic item
%
%\bibitem[ ()]{}
%\end{thebibliography}


\end{document}

\endinput
%%
%% End of file `elsarticle-template-harv.tex'.
